function validate(e){var t=e.type,r=e.name.slice(e.name.lastIndexOf(".")+1).toLowerCase();if(3145728<e.size)return"size_err";switch(t){case"image/jpeg":case"image/jpg":case"image/png":return"ok";default:return"file_err"}switch(r){case"jpg":case"jpeg":return"ok";case"png":return"png";default:return"file_err"}}function alertDiv(e){const t=document.querySelector(".alert");document.querySelector(".alert h5").innerHTML=e,t.style.right="40px",setTimeout(()=>{t.style.right="-400px"},3e3)}function preview(e){const t=new FileReader,r=e.files[0],n=(r.type,r.name.slice(r.name.lastIndexOf(".")+1).toLowerCase(),validate(r)),a=new Image;if("size_err"===n)return alertDiv(errText+"Permission denied. Maximum file size is 30MB.");if("file_err"===n)return alertDiv(errText+"Permission denied. Invalid file type.");const i=document.querySelector(".profile-pic");t.onload=e=>{a.src=e.target.result,a.onload=function(){return this.width/this.height!=1?alertDiv(errText+"Invalid image aspect ratio. Supported aspect ratio: 1:1"):this.width<128?alertDiv(errText+"Minimum image dimensions is 128x128."):2048<this.width?alertDiv(errText+"Maximum image dimensions is 2048x2048"):void(i.src=e.target.result)}},t.readAsDataURL(r)}function changeCountry(e){document.querySelector(".country-flag").src=`https://flagcdn.com/w40/${e}.png`}errText="<svg class='alert-icon' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 320 512'><path d='M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z'/></svg>";const form=document.querySelector(".settings-form");form.addEventListener("submit",async e=>{e.preventDefault();const t=document.getElementById("img-upload").files[0],r=document.querySelector(".form-control").value.trim(),n=document.querySelector("input[name='username']").value.trim(),a=document.querySelector("input[name='name']").value.trim(),i=document.querySelector("input[name='email']").value.trim(),s=document.querySelector("input[name='password']").value.trim(),o=document.querySelector("input[name='new_password']").value.trim(),l=document.querySelector("input[name='repeat_password']").value.trim(),u=new XMLHttpRequest,c=new FormData;return t||""!==r||""!==n||""!==a||""!==i||""!==s||""!==o||""!==l?o!==l?alertDiv(errText+"Passwords not matched."):(c.append("img",t),c.append("country",r),c.append("username",n),c.append("name",a),c.append("email",i),c.append("password",s),c.append("new_password",o),c.append("repeat_password",l),c.append("_csrf",document.querySelector("input[name='_csrf']").value),u.open("POST","/ajax/settings.php",!0),u.onreadystatechange=function(){if(4===this.readyState){if(200===this.status)return alertDiv(`<svg class='alert-icon' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512'><path d='M243.8 339.8C232.9 350.7 215.1 350.7 204.2 339.8L140.2 275.8C129.3 264.9 129.3 247.1 140.2 236.2C151.1 225.3 168.9 225.3 179.8 236.2L224 280.4L332.2 172.2C343.1 161.3 360.9 161.3 371.8 172.2C382.7 183.1 382.7 200.9 371.8 211.8L243.8 339.8zM512 256C512 397.4 397.4 512 256 512C114.6 512 0 397.4 0 256C0 114.6 114.6 0 256 0C397.4 0 512 114.6 512 256zM256 48C141.1 48 48 141.1 48 256C48 370.9 141.1 464 256 464C370.9 464 464 370.9 464 256C464 141.1 370.9 48 256 48z'/></svg>
`+this.responseText);alertDiv(""+errText+this.responseText)}},void u.send(c)):alertDiv(errText+"Please fill in all fields.")});