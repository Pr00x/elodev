function validateEmail(e){return/^\w+@[a-zA-Z_]+?\.[a-zA-Z]{2,20}$/.test(e)}function validateUsername(e){var t='!#$%^&*()+=-[]\\\';,/{}|":<>?"',n=t.length;let r;for(r=0;r<n;r++)if(-1!==e.indexOf(t[r]))return!1;return!0}function validateName(e){return/^[a-zA-Z].*[\s\.]*$/.test(e)}const form=document.querySelector(".register-form");form.addEventListener("submit",async e=>{e.preventDefault();const t=new XMLHttpRequest,n=document.querySelector("input[name='email']").value.trim(),r=document.querySelector("input[name='username']").value.trim(),a=document.querySelector("input[name='name']").value.trim(),i=document.querySelector("input[name='password']").value.trim(),s=document.querySelector("input[name='confirm_password']").value.trim(),u=document.getElementById("err"),m=e=>{u.style.opacity=1,u.textContent=e};if(""===n||""===r||""===a||""===i||""===s)return m("Please fill in all fields.");if(i!==s)return m("Passwords not matched.");if(n.length<6)return m("Minimum email length is 6 characters.");if(128<n.length)return m("Maximum email length is 128 characters.");if(r.length<2)return m("Minimum username length is 2 characters.");if(16<r.length)return m("Maximum username length is 16 characters.");if(a.length<3)return m("Minimum name length is 3 characters.");if(64<a.length)return m("Maximum name length is 64 characters.");if(i.length<8)return m("Minimum password length is 8 characters.");if(256<i.length)return m("Maximum password length is 256 characters");if(!validateUsername(r))return m("Please enter the valid username.");if(!validateEmail(n))return m("Please enter the valid email");if(!validateName(a))return m("Please enter the valid name.");l="http://ip-api.com/json/";const o=await new Promise(e=>{const t=new XMLHttpRequest;t.open("GET",l,!0),t.onreadystatechange=function(){4===this.readyState&&200===this.status&&e(JSON.parse(this.responseText))},t.send()});var l;t.open("POST","/ajax/register.php",!0),t.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),t.setRequestHeader("X-Requested-Width","XMLHttpRequest"),t.onreadystatechange=function(){if(4===this.readyState){if(201===this.status&&"success"===this.responseText)return window.location.href="/login.php";u.style.opacity=1,u.textContent=this.responseText}},t.send(`email=${n}&username=${r}&name=${a}&password=${i}&_csrf=${document.querySelector("input[name='_csrf']").value}&country=${o.country}&country_code=`+o.countryCode.toLowerCase())});
